include DOCKERVERSION

ifeq ($(ARCH),aarch64)
  DOCKER_CROSSPLATFORMS = linux/arm64
else ifeq ($(ARCH),armv7hf)
  DOCKER_CROSSPLATFORMS = linux/arm/v7
else
  $(error No support yet for ARCH "$(ARCH)")
endif

all: dockerd

moby-$(DOCKERVERSION)/bundles/binary/dockerd:
	make -C moby-$(DOCKERVERSION) cross

dockerd: moby-$(DOCKERVERSION)/bundles/binary/dockerd
	cp -L moby-$(DOCKERVERSION)/bundles/binary/$@ .

clean:
	rm -f dockerd moby-$(DOCKERVERSION)
